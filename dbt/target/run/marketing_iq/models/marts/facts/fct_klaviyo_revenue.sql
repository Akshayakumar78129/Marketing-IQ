-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into CLIENT_RARE_SEEDS_DB.PUBLIC_analytics.fct_klaviyo_revenue as DBT_INTERNAL_DEST
        using CLIENT_RARE_SEEDS_DB.PUBLIC_analytics.fct_klaviyo_revenue__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.klaviyo_revenue_sk = DBT_INTERNAL_DEST.klaviyo_revenue_sk))

    
    when matched then update set
        "KLAVIYO_REVENUE_SK" = DBT_INTERNAL_SOURCE."KLAVIYO_REVENUE_SK","PLATFORM" = DBT_INTERNAL_SOURCE."PLATFORM","DATE_DAY" = DBT_INTERNAL_SOURCE."DATE_DAY","PERSON_ID" = DBT_INTERNAL_SOURCE."PERSON_ID","CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","FLOW_ID" = DBT_INTERNAL_SOURCE."FLOW_ID","ATTRIBUTION_TYPE" = DBT_INTERNAL_SOURCE."ATTRIBUTION_TYPE","ORDER_COUNT" = DBT_INTERNAL_SOURCE."ORDER_COUNT","TOTAL_REVENUE" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE","TOTAL_ITEMS" = DBT_INTERNAL_SOURCE."TOTAL_ITEMS","AVG_ORDER_VALUE" = DBT_INTERNAL_SOURCE."AVG_ORDER_VALUE","LAST_SYNCED" = DBT_INTERNAL_SOURCE."LAST_SYNCED"
    

    when not matched then insert
        ("KLAVIYO_REVENUE_SK", "PLATFORM", "DATE_DAY", "PERSON_ID", "CAMPAIGN_ID", "FLOW_ID", "ATTRIBUTION_TYPE", "ORDER_COUNT", "TOTAL_REVENUE", "TOTAL_ITEMS", "AVG_ORDER_VALUE", "LAST_SYNCED")
    values
        ("KLAVIYO_REVENUE_SK", "PLATFORM", "DATE_DAY", "PERSON_ID", "CAMPAIGN_ID", "FLOW_ID", "ATTRIBUTION_TYPE", "ORDER_COUNT", "TOTAL_REVENUE", "TOTAL_ITEMS", "AVG_ORDER_VALUE", "LAST_SYNCED")

;
    commit;