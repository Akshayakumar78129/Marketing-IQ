-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into CLIENT_RARE_SEEDS_DB.PUBLIC_analytics.fct_budget_changes as DBT_INTERNAL_DEST
        using CLIENT_RARE_SEEDS_DB.PUBLIC_analytics.fct_budget_changes__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.budget_change_sk = DBT_INTERNAL_DEST.budget_change_sk))

    
    when matched then update set
        "BUDGET_CHANGE_SK" = DBT_INTERNAL_SOURCE."BUDGET_CHANGE_SK","PLATFORM" = DBT_INTERNAL_SOURCE."PLATFORM","BUDGET_ID" = DBT_INTERNAL_SOURCE."BUDGET_ID","CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","BUDGET_NAME" = DBT_INTERNAL_SOURCE."BUDGET_NAME","BUDGET_AMOUNT" = DBT_INTERNAL_SOURCE."BUDGET_AMOUNT","DELIVERY_METHOD" = DBT_INTERNAL_SOURCE."DELIVERY_METHOD","IS_SHARED_BUDGET" = DBT_INTERNAL_SOURCE."IS_SHARED_BUDGET","BUDGET_PERIOD" = DBT_INTERNAL_SOURCE."BUDGET_PERIOD","REFERENCE_COUNT" = DBT_INTERNAL_SOURCE."REFERENCE_COUNT","BUDGET_STATUS" = DBT_INTERNAL_SOURCE."BUDGET_STATUS","BUDGET_TYPE" = DBT_INTERNAL_SOURCE."BUDGET_TYPE","VALID_FROM" = DBT_INTERNAL_SOURCE."VALID_FROM","VALID_TO" = DBT_INTERNAL_SOURCE."VALID_TO","IS_CURRENT" = DBT_INTERNAL_SOURCE."IS_CURRENT","CHANGE_DATE" = DBT_INTERNAL_SOURCE."CHANGE_DATE","DAYS_ACTIVE" = DBT_INTERNAL_SOURCE."DAYS_ACTIVE","LAST_SYNCED" = DBT_INTERNAL_SOURCE."LAST_SYNCED"
    

    when not matched then insert
        ("BUDGET_CHANGE_SK", "PLATFORM", "BUDGET_ID", "CAMPAIGN_ID", "BUDGET_NAME", "BUDGET_AMOUNT", "DELIVERY_METHOD", "IS_SHARED_BUDGET", "BUDGET_PERIOD", "REFERENCE_COUNT", "BUDGET_STATUS", "BUDGET_TYPE", "VALID_FROM", "VALID_TO", "IS_CURRENT", "CHANGE_DATE", "DAYS_ACTIVE", "LAST_SYNCED")
    values
        ("BUDGET_CHANGE_SK", "PLATFORM", "BUDGET_ID", "CAMPAIGN_ID", "BUDGET_NAME", "BUDGET_AMOUNT", "DELIVERY_METHOD", "IS_SHARED_BUDGET", "BUDGET_PERIOD", "REFERENCE_COUNT", "BUDGET_STATUS", "BUDGET_TYPE", "VALID_FROM", "VALID_TO", "IS_CURRENT", "CHANGE_DATE", "DAYS_ACTIVE", "LAST_SYNCED")

;
    commit;