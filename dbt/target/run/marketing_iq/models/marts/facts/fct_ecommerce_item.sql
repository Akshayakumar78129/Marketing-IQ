-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into CLIENT_RARE_SEEDS_DB.PUBLIC_analytics.fct_ecommerce_item as DBT_INTERNAL_DEST
        using CLIENT_RARE_SEEDS_DB.PUBLIC_analytics.fct_ecommerce_item__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.ecommerce_item_sk = DBT_INTERNAL_DEST.ecommerce_item_sk))

    
    when matched then update set
        "ECOMMERCE_ITEM_SK" = DBT_INTERNAL_SOURCE."ECOMMERCE_ITEM_SK","PLATFORM" = DBT_INTERNAL_SOURCE."PLATFORM","DATE_DAY" = DBT_INTERNAL_SOURCE."DATE_DAY","PROPERTY" = DBT_INTERNAL_SOURCE."PROPERTY","ITEM_NAME" = DBT_INTERNAL_SOURCE."ITEM_NAME","ITEMS_VIEWED" = DBT_INTERNAL_SOURCE."ITEMS_VIEWED","ITEMS_ADDED_TO_CART" = DBT_INTERNAL_SOURCE."ITEMS_ADDED_TO_CART","ITEMS_PURCHASED" = DBT_INTERNAL_SOURCE."ITEMS_PURCHASED","REVENUE" = DBT_INTERNAL_SOURCE."REVENUE","CART_TO_VIEW_RATE" = DBT_INTERNAL_SOURCE."CART_TO_VIEW_RATE","PURCHASE_TO_VIEW_RATE" = DBT_INTERNAL_SOURCE."PURCHASE_TO_VIEW_RATE","CALCULATED_CART_RATE" = DBT_INTERNAL_SOURCE."CALCULATED_CART_RATE","CART_TO_PURCHASE_RATE" = DBT_INTERNAL_SOURCE."CART_TO_PURCHASE_RATE","AVG_ITEM_REVENUE" = DBT_INTERNAL_SOURCE."AVG_ITEM_REVENUE","LAST_SYNCED" = DBT_INTERNAL_SOURCE."LAST_SYNCED"
    

    when not matched then insert
        ("ECOMMERCE_ITEM_SK", "PLATFORM", "DATE_DAY", "PROPERTY", "ITEM_NAME", "ITEMS_VIEWED", "ITEMS_ADDED_TO_CART", "ITEMS_PURCHASED", "REVENUE", "CART_TO_VIEW_RATE", "PURCHASE_TO_VIEW_RATE", "CALCULATED_CART_RATE", "CART_TO_PURCHASE_RATE", "AVG_ITEM_REVENUE", "LAST_SYNCED")
    values
        ("ECOMMERCE_ITEM_SK", "PLATFORM", "DATE_DAY", "PROPERTY", "ITEM_NAME", "ITEMS_VIEWED", "ITEMS_ADDED_TO_CART", "ITEMS_PURCHASED", "REVENUE", "CART_TO_VIEW_RATE", "PURCHASE_TO_VIEW_RATE", "CALCULATED_CART_RATE", "CART_TO_PURCHASE_RATE", "AVG_ITEM_REVENUE", "LAST_SYNCED")

;
    commit;