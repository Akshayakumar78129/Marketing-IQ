-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into CLIENT_RARE_SEEDS_DB.PUBLIC_analytics.fct_ad_group_settings_history as DBT_INTERNAL_DEST
        using CLIENT_RARE_SEEDS_DB.PUBLIC_analytics.fct_ad_group_settings_history__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.ad_group_settings_sk = DBT_INTERNAL_DEST.ad_group_settings_sk))

    
    when matched then update set
        "AD_GROUP_SETTINGS_SK" = DBT_INTERNAL_SOURCE."AD_GROUP_SETTINGS_SK","PLATFORM" = DBT_INTERNAL_SOURCE."PLATFORM","AD_GROUP_ID" = DBT_INTERNAL_SOURCE."AD_GROUP_ID","CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","BASE_AD_GROUP_ID" = DBT_INTERNAL_SOURCE."BASE_AD_GROUP_ID","AD_GROUP_NAME" = DBT_INTERNAL_SOURCE."AD_GROUP_NAME","AD_GROUP_STATUS" = DBT_INTERNAL_SOURCE."AD_GROUP_STATUS","AD_GROUP_TYPE" = DBT_INTERNAL_SOURCE."AD_GROUP_TYPE","AD_ROTATION_MODE" = DBT_INTERNAL_SOURCE."AD_ROTATION_MODE","VALID_FROM" = DBT_INTERNAL_SOURCE."VALID_FROM","VALID_TO" = DBT_INTERNAL_SOURCE."VALID_TO","IS_CURRENT" = DBT_INTERNAL_SOURCE."IS_CURRENT","CHANGE_DATE" = DBT_INTERNAL_SOURCE."CHANGE_DATE","DAYS_ACTIVE" = DBT_INTERNAL_SOURCE."DAYS_ACTIVE","LAST_SYNCED" = DBT_INTERNAL_SOURCE."LAST_SYNCED"
    

    when not matched then insert
        ("AD_GROUP_SETTINGS_SK", "PLATFORM", "AD_GROUP_ID", "CAMPAIGN_ID", "BASE_AD_GROUP_ID", "AD_GROUP_NAME", "AD_GROUP_STATUS", "AD_GROUP_TYPE", "AD_ROTATION_MODE", "VALID_FROM", "VALID_TO", "IS_CURRENT", "CHANGE_DATE", "DAYS_ACTIVE", "LAST_SYNCED")
    values
        ("AD_GROUP_SETTINGS_SK", "PLATFORM", "AD_GROUP_ID", "CAMPAIGN_ID", "BASE_AD_GROUP_ID", "AD_GROUP_NAME", "AD_GROUP_STATUS", "AD_GROUP_TYPE", "AD_ROTATION_MODE", "VALID_FROM", "VALID_TO", "IS_CURRENT", "CHANGE_DATE", "DAYS_ACTIVE", "LAST_SYNCED")

;
    commit;