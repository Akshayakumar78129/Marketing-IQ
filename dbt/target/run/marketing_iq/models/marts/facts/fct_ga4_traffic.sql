-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into CLIENT_RARE_SEEDS_DB.PUBLIC_analytics.fct_ga4_traffic as DBT_INTERNAL_DEST
        using CLIENT_RARE_SEEDS_DB.PUBLIC_analytics.fct_ga4_traffic__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.ga4_traffic_sk = DBT_INTERNAL_DEST.ga4_traffic_sk))

    
    when matched then update set
        "GA4_TRAFFIC_SK" = DBT_INTERNAL_SOURCE."GA4_TRAFFIC_SK","PLATFORM" = DBT_INTERNAL_SOURCE."PLATFORM","DATE_DAY" = DBT_INTERNAL_SOURCE."DATE_DAY","PROPERTY" = DBT_INTERNAL_SOURCE."PROPERTY","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","MEDIUM" = DBT_INTERNAL_SOURCE."MEDIUM","SOURCE_MEDIUM" = DBT_INTERNAL_SOURCE."SOURCE_MEDIUM","SESSIONS" = DBT_INTERNAL_SOURCE."SESSIONS","ENGAGED_SESSIONS" = DBT_INTERNAL_SOURCE."ENGAGED_SESSIONS","TOTAL_USERS" = DBT_INTERNAL_SOURCE."TOTAL_USERS","EVENT_COUNT" = DBT_INTERNAL_SOURCE."EVENT_COUNT","CONVERSIONS" = DBT_INTERNAL_SOURCE."CONVERSIONS","REVENUE" = DBT_INTERNAL_SOURCE."REVENUE","ENGAGEMENT_RATE" = DBT_INTERNAL_SOURCE."ENGAGEMENT_RATE","EVENTS_PER_SESSION" = DBT_INTERNAL_SOURCE."EVENTS_PER_SESSION","USER_ENGAGEMENT_DURATION" = DBT_INTERNAL_SOURCE."USER_ENGAGEMENT_DURATION","CALCULATED_ENGAGEMENT_RATE" = DBT_INTERNAL_SOURCE."CALCULATED_ENGAGEMENT_RATE","SESSIONS_PER_USER" = DBT_INTERNAL_SOURCE."SESSIONS_PER_USER","LAST_SYNCED" = DBT_INTERNAL_SOURCE."LAST_SYNCED"
    

    when not matched then insert
        ("GA4_TRAFFIC_SK", "PLATFORM", "DATE_DAY", "PROPERTY", "SOURCE", "MEDIUM", "SOURCE_MEDIUM", "SESSIONS", "ENGAGED_SESSIONS", "TOTAL_USERS", "EVENT_COUNT", "CONVERSIONS", "REVENUE", "ENGAGEMENT_RATE", "EVENTS_PER_SESSION", "USER_ENGAGEMENT_DURATION", "CALCULATED_ENGAGEMENT_RATE", "SESSIONS_PER_USER", "LAST_SYNCED")
    values
        ("GA4_TRAFFIC_SK", "PLATFORM", "DATE_DAY", "PROPERTY", "SOURCE", "MEDIUM", "SOURCE_MEDIUM", "SESSIONS", "ENGAGED_SESSIONS", "TOTAL_USERS", "EVENT_COUNT", "CONVERSIONS", "REVENUE", "ENGAGEMENT_RATE", "EVENTS_PER_SESSION", "USER_ENGAGEMENT_DURATION", "CALCULATED_ENGAGEMENT_RATE", "SESSIONS_PER_USER", "LAST_SYNCED")

;
    commit;